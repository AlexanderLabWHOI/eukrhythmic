configfile: "config.yaml"

import io
import os
from snakemake.exceptions import print_exception, WorkflowError

OUTPUTDIR = config["outputDIR"]
INPUTDIR = config["inputDIR"]

ASSEMBLYFILE = pd.read_csv(config["metaT_sample"], sep = "\t")
ASSEMBLYDICT = dict(zip(list(ASSEMBLYFILE.AssemblyGroup), list(ASSEMBLYFILE.SampleName)))
ASSEMBLEDDIR = os.path.join(OUTPUTDIR, config['assembledDIR'])
ASSEMBLERS = list(config['assemblers'])

sed 's/>.*/&_phosphate/' foo.in >bar.out

# this rule is meant to change the name of the headers for the FASTA files for 
# each of the assemblies so that we can track where each of the headers originally
# came from

rule rename:
    input:
        assemblyfiles = expand(os.path.join(ASSEMBLEDDIR, "{assembly}_{assembler}.fasta"), assembly = "{assembly}", assembler = ASSEMBLERS)
    output:
        expand(os.path.join(OUTPUTDIR, "renamed", "{assembly}_{assembler}.fasta"), assembly = "{assembly}", assembler = ASSEMBLERS)
    params:
        assemblername = {assembler}
    shell:
        '''
        sed 'sed 's/>/>{params.assemblername}_/'' {input.assemblyfiles} > {output}
        '''